<!DOCTYPE html>
<!--[if IE 8]> <html lang="en" class="ie8"> <![endif]-->
<!--[if IE 9]> <html lang="en" class="ie9"> <![endif]-->
<!--[if !IE]><!--> <html lang="en"> <!--<![endif]-->
<head>
	<title>융합캡스톤디자인</title>

	<!-- Meta -->
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="description" content="">
	<meta name="author" content="">

	<!-- Favicon -->
	<link rel="shortcut icon" href="favicon.ico">

	<!-- Web Fonts -->
	<link rel='stylesheet' type='text/css' href='//fonts.googleapis.com/css?family=Noto+Sans'>

	<!-- CSS Global Compulsory -->
	<link rel="stylesheet" href="assets/plugins/bootstrap/css/bootstrap.min.css">
	<link rel="stylesheet" href="assets/css/style.css">

	<!-- CSS Header and Footer -->
	<link rel="stylesheet" href="assets/css/headers/header-v6.css">
	<link rel="stylesheet" href="assets/css/footers/footer-v1.css">

	<!-- CSS Implementing Plugins -->
	<link rel="stylesheet" href="assets/plugins/animate.css">
	<link rel="stylesheet" href="assets/plugins/line-icons/line-icons.css">
	<link rel="stylesheet" href="assets/plugins/font-awesome/css/font-awesome.min.css">
	<link rel="stylesheet" href="assets/plugins/sky-forms-pro/skyforms/css/sky-forms.css">
	<link rel="stylesheet" href="assets/plugins/sky-forms-pro/skyforms/custom/custom-sky-forms.css">
	<link rel="stylesheet" href="assets/plugins/cube-portfolio/cubeportfolio/css/cubeportfolio.css">
	<link rel="stylesheet" href="assets/plugins/cube-portfolio/cubeportfolio/custom/custom-cubeportfolio.css">
	

	<!-- CSS Page Style -->
	<link rel="stylesheet" href="assets/css/pages/page_search_inner.css">

	<!-- CSS Theme -->
	<link rel="stylesheet" href="assets/css/theme-colors/default.css" id="style_color">

	<!-- CSS Customization -->
	<link rel="stylesheet" href="assets/css/custom.css">
	
	<!-- AngularJS -->
	<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.4/angular.min.js"></script>
	
</head>

<body class="header-fixed">
	<div class="wrapper">
		<!--=== Header v6 ===-->
		<div class="header-v6 header-classic-white">
			<!-- Navbar -->
			<div class="navbar" role="navigation">
				<div class="container">
					<!-- Brand and toggle get grouped for better mobile display -->
					<div class="menu-container">
						<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
							<span class="sr-only">Toggle navigation</span>
							<span class="icon-bar"></span>
							<span class="icon-bar"></span>
							<span class="icon-bar"></span>
						</button>

						<!-- Navbar Brand -->
						<div class="navbar-brand">
							<a href="index.html">
								<img class="shrink-logo" src="assets/img/icons/logo-2_s.png" alt="Capstone Expo">
							</a>
						</div>
						<!-- ENd Navbar Brand -->
					</div>

					<!-- Collect the nav links, forms, and other content for toggling -->
					<div class="collapse navbar-collapse navbar-responsive-collapse">
						<div class="menu-container">
							<ul class="nav navbar-nav">
								<!-- Home -->
								<li class="active">
									<a href="index.html">
										Home
									</a>
								</li>
								<!-- End Home -->
								
								<!-- Discover -->
								<li>
									<a href="search_projects.html">
										Discover Projects
									</a>
								</li>
								<!-- End Discover -->
								
								<!-- My Menu -->
								<li class="dropdown">
									<a href="javascript:void(0);" class="dropdown-toggle" data-toggle="dropdown">
										My Menu
									</a>
									<ul class="dropdown-menu pull-right">
										<li>
											<a href="my_page.html">My Page</a>
										</li>
										<li class="dropdown-submenu">
											<a href="javascript:void(0);">My Projects</a>
											<ul class="dropdown-menu submenu-left">
												<li><a href="project_details.html">CapstoneExpo</a></li>
											</ul>
										</li>
										<li><a href="blog_timeline.html">Sign out</a></li>
									</ul>
								</li>
								<!-- End My Menu -->

							</ul>
						</div>
					</div><!--/navbar-collapse-->
				</div>
			</div>
			<!-- End Navbar -->
		</div>
		<!--=== End Header v6 ===-->
		
		<!--=== Search Block Version 2 ===-->
		<div class="search-block-v2 gray-background">
			<div class="container">
				<div class="col-md-6 col-md-offset-3">
					<h2>찾으시는 프로젝트를 검색해보세요.</h2>
					<form id="ajaxform" method="get">
					<div class="input-group">	
						<input type="text" id= "keyword" class="form-control" placeholder="프로젝트 명 검색">
						<span class="input-group-btn">					
							<button class="btn-u" id=search type="submit"><i class="fa fa-search"></i></button>
						</span>						
					</div>
					</form>
				</div>
			</div>
		</div><!--/container-->
		<!--=== End Search Block Version 2 ===-->

		<!--=== Search Results ===-->
		<div class="container s-results margin-bottom-50" ng-app="searchApp" ng-element-ready>
			<div class="row">
				<div class="col-md-2 col-sm-12 hidden-xs related-search">

					<h3>Categories</h3>
							<div id="filters-container" class="cbp-l-filters-text list-unstyled">
								<div data-filter="*" class="cbp-filter-item-active cbp-filter-item">전체</div>
								<div data-filter=".mech" class="cbp-filter-item">기계/항공</div>
								<div data-filter=".elec" class="cbp-filter-item">전기/전자</div>
								<div data-filter=".soft" class="cbp-filter-item">소프트웨어</div>
								<div data-filter=".arch" class="cbp-filter-item">건축/환경</div>
								<div data-filter=".ener" class="cbp-filter-item">화공/에너지</div>
								<div data-filter=".scie" class="cbp-filter-item">자연과학</div>
								<div data-filter=".desi" class="cbp-filter-item">예술/디자인</div>
								<div data-filter=".educ" class="cbp-filter-item">생활/교육</div>
								<div data-filter=".misc" class="cbp-filter-item">기타 </div>
							</div>
							<!-- <hr> -->
					<hr>
					<h3>Sort by</h3>
					<ul id="sorting-jen" class="row filters-list-jen list-unstyled">
						<li id="sort-view" class="col-md-12 col-sm-4 filter-item-active filter-item-jen">
							<a href="#" onclick="window.location.href=window.location.href.split('?')[0];">조회수 많은 순</a></li>
						<li id="sort-recent" class="col-md-12 col-sm-4 filter-item-jen">
							<a href="#" onclick="window.location.href=window.location.href.split('?')[0]+'?newest=true';">시작일 순</a></li>
					</ul>

				</div><!--/col-md-2-->
				<div class="col-md-10 col-sm-12" ng-controller="ProjectDisplayController">
					<span class="results-number">총 {{count}} 프로젝트
					<button class="btn-u pull-right" type="button" data-toggle="modal" data-target="#responsive">신규 프로젝트 등록</button>
					</span>					
					
					<!--=== Cube-Portfolio ===-->
					<div class="cube-portfolio margin-bottom-60">
						<div id="grid-container" class="cbp-l-grid-agency">
			 				<div class="cbp-item {{map(p.field,map_one)}}" ng-repeat="p in projects">
								<div class="cbp-caption margin-bottom-10">
									<div class="cbp-caption-defaultWrap easy-block-v1">
										<img class="img-responsive" src="/image/download/{{p.image}}" alt="">
									</div>
									<div class="cbp-caption-activeWrap">
										<div class="cbp-l-caption-alignCenter">
											<div class="cbp-l-caption-body">
												<ul class="link-captions no-bottom-space">
													<li><a href="jisu_timeline_angular.html?id={{p._id}}"><i class="rounded-x fa fa-search-plus"></i></a></li>										
												</ul>
											</div>
										</div>
									</div>
								</div>
								<div class="cbp-title-dark project-box">
									<div class="headline-left margin-bottom-10 project_title">{{p.name}}</div>
									<small class="project-tag"><span class="color-green">분야: &nbsp;</span>{{map(p.field,comma)}}</small>
									<small class="project-tag"><span class="color-green">기간: &nbsp;</span>2016/03~2016/12</small>
									<p>{{p.shortIntro}}</p>
								</div>
							</div>
			
						</div><!--/end Grid Container-->
					</div>
					<!--=== End Cube-Portfolio ===-->
					
				</div><!--/col-md-10-->
			</div>
		</div><!--/container-->
		<!--=== End Search Results ===-->
	</div><!--/End Wrapper-->

	<!-- 신규 프로젝트 등록 modal -->
	<div class="modal fade" id="responsive" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
					<h4 class="modal-title" id="myModalLabel4">신규 프로젝트 등록</h4>
				</div>

				<div class="panel-body sky-form">
					<form id="imageForm" class="form-horizontal sky-form no-border" role="form"  method="post" enctype="multipart/form-data">
					
						<div class="form-group">
							<label for="inputCategory" class="col-lg-2 control-label">분야</label>
							<div id="input-field" class="col-lg-10 inline-group jen-checkbox">
								<label class="checkbox jen-checkbox-item"><input type="checkbox" name="checkbox-inline" value="기계/항공"><i></i>기계/항공</label>
								<label class="checkbox jen-checkbox-item"><input type="checkbox" name="checkbox-inline" value="전기/전자"><i></i>전기/전자</label>
								<label class="checkbox jen-checkbox-item"><input type="checkbox" name="checkbox-inline" value="소프트웨어"><i></i>소프트웨어</label>
								<label class="checkbox jen-checkbox-item"><input type="checkbox" name="checkbox-inline" value="건축/환경"><i></i>건축/환경</label>
								<label class="checkbox jen-checkbox-item"><input type="checkbox" name="checkbox-inline" value="화공/에너지"><i></i>화공/에너지</label>
								<label class="checkbox jen-checkbox-item"><input type="checkbox" name="checkbox-inline" value="자연과학"><i></i>자연과학</label>
								<label class="checkbox jen-checkbox-item"><input type="checkbox" name="checkbox-inline" value="예술/디자인"><i></i>예술/디자인</label>
								<label class="checkbox jen-checkbox-item"><input type="checkbox" name="checkbox-inline" value="생활/교육"><i></i>생활/교육</label>
								<label class="checkbox jen-checkbox-item"><input type="checkbox" name="checkbox-inline" value="기타"><i></i>기타</label>
							</div>
						</div>											

						<div class="form-group">
							<label for="inputTitle" class="col-lg-2 control-label">프로젝트명:</label>
							<div class="col-lg-10">
								<input type="text" class="form-control" id="input-name" name="name" placeholder="프로젝트명">
							</div>
						</div>
						<div class="form-group">
							<label for="inputIntro" class="col-lg-2 control-label">요약글:</label>
							<div class="col-lg-10">
								<input type="text" class="form-control" id="input-short-intro" name="shortIntro" placeholder="한 줄 소개">
							</div>
						</div>
						<div class="form-group">
							<label for="inputDesc" class="col-lg-2 control-label">소개글:</label>
							<div class="col-lg-10 textarea">
								<textarea id="inputDesc" class="form-control" rows="5" id="input-intro" name="intro" placeholder="프로젝트를 소개해주세요."></textarea>
							</div>
						</div>
						<div class="form-group">
							<label for="inputDate" class="col-lg-2 control-label">기간:</label>
							<div class="col-lg-10 inline-group">
								<div class="col-4 date-picker">
									<label class="input">
										<i class="icon-append fa fa-calendar"></i>
										<input type="text" name="start" id="start" name="startDate" placeholder="프로젝트 시작">
									</label>
								</div>
								<div class="col-4 date-picker">
									<label class="input">
										<i class="icon-append fa fa-calendar"></i>
										<input type="text" name="finish" id="finish" name="endDate" placeholder="종료 예정일">
									</label>
								</div>
							</div>
						</div>

						<div class="form-group">
							<label for="inputImage" class="col-lg-2 control-label">대표이미지:</label>
							<div class="col-lg-10">
								<label for="file" class="input input-file">
									<div class="button"><input type="file" id="uploadFile" name="uploadFile" onchange="this.parentNode.nextSibling.value = this.value">Browse</div><input type="text" readonly>
								</label>
							</div>
						</div>
						<div class="modal-footer">
						<button type="button" class="btn-u btn-u-default" data-dismiss="modal">취소</button>
						<button type="submit" class="btn-u btn-u-primary">프로젝트 생성</button>
						</div>
					</form>
				</div>


			</div>
		</div>
	</div>
	<!-- end 신규 프로젝트 생성 -->

	<!-- JS Global Compulsory -->
	<script type="text/javascript" src="assets/plugins/jquery/jquery.min.js"></script>
	<script type="text/javascript" src="assets/plugins/jquery/jquery-migrate.min.js"></script>
	<script type="text/javascript" src="assets/plugins/bootstrap/js/bootstrap.min.js"></script>
	<!-- JS Implementing Plugins -->
	<script type="text/javascript" src="assets/plugins/back-to-top.js"></script>
	<script type="text/javascript" src="assets/plugins/smoothScroll.js"></script>
	<script src="assets/plugins/sky-forms-pro/skyforms/js/jquery.maskedinput.min.js"></script>
	<script src="assets/plugins/sky-forms-pro/skyforms/js/jquery-ui.min.js"></script>
	<script src="assets/plugins/sky-forms-pro/skyforms/js/jquery.validate.min.js"></script>
	<script type="text/javascript" src="assets/plugins/counter/waypoints.min.js"></script>
	<script type="text/javascript" src="assets/plugins/cube-portfolio/cubeportfolio/js/jquery.cubeportfolio.js"></script>
	<script src="assets/plugins/sky-forms-pro/skyforms/js/jquery.form.min.js"></script>
	<script type="text/javascript" src="assets/plugins/sky-forms-pro/skyforms/js/jquery-ui.min.js"></script>
	<script type="text/javascript" src="assets/plugins/sky-forms-pro/skyforms/js/jquery.form.min.js"></script>
	<script type="text/javascript" src="assets/plugins/sky-forms-pro/skyforms/js/jquery.validate.min.js"></script>
	<!-- JS Customization -->
	<script type="text/javascript" src="assets/js/custom.js"></script>
	<!-- JS Page Level -->
	<script type="text/javascript" src="assets/js/app.js"></script>
	<script type="text/javascript" src="assets/js/plugins/datepicker.js"></script>
	<script type="text/javascript" src="assets/js/plugins/validation.js"></script>
	<!-- script type="text/javascript" src="assets/js/plugins/cube-portfolio/cube-portfolio-3.js"></script-->
	<script type="text/javascript">
	function open_win() {
		var singleText = "single";
		var s = window.location.search;

		if (s.indexOf(singleText) == -1) {
		    window.location.href += (s.substring(0,1) == "?") ? "&" : "?" + singleText;
		}
	}
	
	var module=angular.module('searchApp', []);
	module.controller('ProjectDisplayController', function($scope,$http) {
		var sorting = '';
		var arg=window.location.search.substring(1).split('&')[0].split('=');
        if(arg[0]==='newest' && arg[1]==='true') {
        	sorting = '/project/all/new';
        } else {
        	sorting = '/project/all/view';
        }
		
		$http.get('http://'+document.location.host+sorting).then(function(res){
			$scope.projects=res.data.result;
			$scope.count=res.data.result.length;
			$scope.map_one=function(fieldName){
				switch(fieldName) {
				case "기계/항공":
					return "mech";
				case "전기/전자":
					return "elec";
				case "소프트웨어":
					return "soft";
				case "건축/환경":
					return "arch";
				case "화공/에너지":
					return "ener";
				case "자연과학":
					return "scie";
				case "예술/디자인":
					return "desi";
				case "생활/교육":
					return "educ";
				case "기타":
					return "misc";
				}
				return "";
			};
			$scope.comma=function(a){
				return a+', ';
			};

			$scope.map=function(fields,func){
				var result='';
				for(i in fields)
					result+= func(fields[i])+' ';
				return result;
			};
		});
	});
	module.directive('ngElementReady', ['$timeout', function($timeout) {
        return {
            restrict: "A", // attribute only
            link: function($scope, $element, $attributes) {
                angular.getTestability($element).whenStable(ready);
            }
        };
    }]);

	function upload(callback){
		return function(event){
		event.preventDefault();
		$.ajax({
			contentType: false,
			processData: false,
	        data: new FormData($(this)[0]),
	        type: $(this).attr('method'),
	        url: '/image/upload',
	        success: function(response) {
	        	if(response.error) alert(response.error);
	        	else{
	        		callback(response);
	        	}
	        }
	    });
	}};
	
	$(".project-image-box").outerHeight($(".project-image-box").outerWidth() * 0.60);

	function ready() {
		//App.init();
		Datepicker.initDatepicker();
		Validation.initValidation();
		$.getScript("assets/js/plugins/cube-portfolio/cube-portfolio-3.js");
		$("#imageForm").submit(upload(function(response){
			if(response.error){
				alert("Fail");
				return;
			}
			var testdata={};
			testdata.projectSummary={};
			testdata.projectSummary.name=$("#input-name").val();
			testdata.projectSummary.shortIntro=$("#input-short-intro").val();
			testdata.projectSummary.intro=$("#input-intro").val();
			testdata.projectSummary.status="신규";
			testdata.projectSummary.startDate=$("#start").val();
			testdata.projectSummary.endDate=$("#finish").val();
			testdata.projectSummary.field=$("#input-field input:checked").map(function(_, el) {
		        return $(el).attr('value');
		    }).get();
			testdata.projectSummary.image=response.result;
			$.post('http://'+document.location.host+'/project/new',testdata,function(res){
				// 여기서 처리 결과를 가지고 오류 처리 등을 합니다. 자세한 내용은 testread.html을 참고합니다.
				//alert(JSON.stringify(res.result));
				location.reload(true);
			});
		}));
	}
	
	jQuery(document).ready(function() {
		App.init();
		
		$(function(){
			$("#ajaxform").submit(function(){
				var keyword = $("#keyword").val();
					alert(keyword);
				$.getJSON('http://'+document.location.host+'/search/'+$("#keyword").val(), function(res){
					alert(keyword+" 전송완료");
					alert(JSON.stringify(res.result));
				});			
			});
		});
	});
	
	
	/*
		$("#search").get(){
		function search(callback){
			//alert($(this)[0]);
		//event.preventDefault();
		$.get('http://'+document.location.host+'/project/'+$("#keyword"),report,function(res){
			// 여기서 처리 결과를 가지고 오류 처리 등을 합니다. 자세한 내용은 testread.html을 참고합니다.
			alert(JSON.stringify(res.result));
			alert("검색어 전송"); 
		});		
	};
}*/
	
	</script>
	<!--[if lt IE 9]>
	<script src="assets/plugins/respond.js"></script>
	<script src="assets/plugins/html5shiv.js"></script>
	<script src="assets/plugins/placeholder-IE-fixes.js"></script>
	<![endif]-->
</body>
</html>
